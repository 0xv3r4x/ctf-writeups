# Incredibly Covert Malware Procedures | Forensics

*We got hacked! Can you see what they took?*

Opening the `.pcap` file in `wireshark` shows a lot of ICMP traffic.  Using the filter:

```
ip.src==192.168.8.114 && icmp
```

Looking through the filtered packets, I noticed the `PNG` signature.  I now looked for the offset of data which will likely contain the flag using `tshark` and `python`

```
$ sudo tshark -r incident.pcap -T fields -e data > icmp_data.txt
```

```python
with open("icmp_data.txt") as f:
	for line in f:
		print(line[16:48])
```

```
$ python3 extract_icmp.py > processed_icmp_data.txt
$ cat processed_icmp_data.txt | xxd -r -p > icmp_flag.png
```

The flag is:

```
flag{not_so_stealthy_exfil}
```